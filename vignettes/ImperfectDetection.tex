\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={Sampling regimes for rare species with imperfect detection},
            pdfauthor={Jens Åström},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\newcommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{Sampling regimes for rare species with imperfect detection}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Jens Åström}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{2018-11-23}


% You know, for landscape
\usepackage{lscape}
\usepackage{pdfpages}


% pandoc does not parse latex env - https://groups.google.com/forum/?fromgroups=#!topic/pandoc-discuss/oZETB5Ii1Cw
\newcommand{\blandscape}{\begin{landscape}}
\newcommand{\elandscape}{\end{landscape}}

\begin{document}
\maketitle

\section{Intro}\label{intro}

I here explore some effects of rare occurrence and imperfect detection
in species observation and explore alternative survey regimes. This is
mostly relevant for rare species, and not for the general survey of
insects. Early detection of alien species is another use case.

The objective is to identify suitable sampling strategies for a couple
of different scenarios, where we maximise the chances of detecting a
species at least once while considering the economic costs. The basic
principle here is that a species can be present in a sampling location
with a given probability of occurrence. The observers then have a given
chance (probability) of detecting a species on a visit, if it is
present. The total probability of of detecting a species will be
dependent on both the probability of occurrence and the probability of
detection, how many locations are visited, and how many visits we make
at each location.

If \(\psi\) represents the occurrence probability and \(\theta\) is the
detection probability, the probability of observing the species at least
once in \(J\) locations visited \(K\) times is:
\[probObserv = 1 - (1 - \psi * (1 - (1 - \theta)^K))^J.\] The costs can
be assumed to scale roughly linearly to the total amount of visits, i.e.
\(totalCost = J * K * c\), where \(c\) is the cost of one visit/survey.

\section{First look}\label{first-look}

We can explore how the overall probability of observing the species, and
the associated costs depend on \(\psi, \theta, J, K, c\) graphically. I
have made a convenience function \texttt{obsProb} to calculate the
values. A lot of the results seem pretty obvious in retrospect, but it
is still worth plotting them to get a better feel for the possibilities.
At the moment, we only consider one and the same cost for each survey
visit. It may be worth while to code up using a higher initial cost of
the first visit, and lower costs for subsequent visits.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{require}\NormalTok{(InsectSurvPower)}
\NormalTok{## custom library, available through}
\NormalTok{## devtools::install_github('NINAnor/InsectSurvPower')}
\KeywordTok{require}\NormalTok{(dplyr)}
\KeywordTok{require}\NormalTok{(gridExtra)}
\KeywordTok{require}\NormalTok{(ggplot2)}
\KeywordTok{require}\NormalTok{(xtable)}
\end{Highlighting}
\end{Shaded}

We specify one or a range of values for occurrence probability in each
location, detection probabilities, the number of locations visited, the
number of visits per location, and the cost of each visit. To
illustrate, we here use occurrence probabilities ranging from 0.01 to 1,
two different detection probabilities as 0.5, and 0.8. We specify 30
locations, each visited 4 times, at an individual visit cost of 5000.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{obsDf <-}\StringTok{ }\KeywordTok{obsProb}\NormalTok{(}\DataTypeTok{occProb =} \KeywordTok{seq}\NormalTok{(}\FloatTok{0.01}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DataTypeTok{by =} \FloatTok{0.05}\NormalTok{), }\DataTypeTok{detectProb =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.5}\NormalTok{, }\FloatTok{0.8}\NormalTok{), }
    \DataTypeTok{locations =} \DecValTok{30}\NormalTok{, }\DataTypeTok{visits =} \DecValTok{4}\NormalTok{, }\DataTypeTok{visitCost =} \DecValTok{5000}\NormalTok{)}

\NormalTok{obsDf}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 40 x 7
##    occProb detectProb locations visits visitCost obsProb totCost
##      <dbl>      <dbl>     <dbl>  <dbl>     <dbl>   <dbl>   <dbl>
##  1  0.0100      0.500      30.0   4.00      5000   0.244  600000
##  2  0.0600      0.500      30.0   4.00      5000   0.791  600000
##  3  0.110       0.500      30.0   4.00      5000   0.909  600000
##  4  0.160       0.500      30.0   4.00      5000   0.932  600000
##  5  0.210       0.500      30.0   4.00      5000   0.937  600000
##  6  0.260       0.500      30.0   4.00      5000   0.937  600000
##  7  0.310       0.500      30.0   4.00      5000   0.937  600000
##  8  0.360       0.500      30.0   4.00      5000   0.937  600000
##  9  0.410       0.500      30.0   4.00      5000   0.937  600000
## 10  0.460       0.500      30.0   4.00      5000   0.937  600000
## # ... with 30 more rows
\end{verbatim}

The probability of observing the species at least once is found in the
\texttt{obsProb} column, and the total cost in the column
\texttt{totCost}. The function returns an object of a specific class
with a custom plotting function. This makes repeated plottings easier.
We can specify a grouping variable to split up the lines.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(obsDf, }\DataTypeTok{group =} \StringTok{"detectProb"}\NormalTok{, }\DataTypeTok{xVar =} \StringTok{"occProb"}\NormalTok{, }\DataTypeTok{yVar =} \StringTok{"obsProb"}\NormalTok{, }\DataTypeTok{titleVar =} \KeywordTok{c}\NormalTok{(}\StringTok{"locations"}\NormalTok{, }
    \StringTok{"visits"}\NormalTok{), }\DataTypeTok{hline =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/princPlot-1.png}
\caption{Observation probability for surveying a species with a
detection probability of 0.5 in 30 locations, each visited 4 times.
\label{princPlot}}
\end{figure}

Figure \ref{princPlot} shows how the overall obervation probability is
dependent on both occurrence and detection probability. A threshold of a
total observation probability of 0.8 is added for comparison. The
threshold is reached in this case when the probability of occurrence in
each location is 6\%. With 30 locations, the overall observation
probability rises quite sharply as a result of increased occurrence
probability. With only 4 visits per location, the detection probability
limits the overall achievable observation probability.

However, these occurrence probabilities are probably unreasonably high
for rare species in the real world. If we assume that we search for a
truly rare species with an occurrence probability of only 0.001, we find
that reaching overall detectabilities above 80\% is challenging (Figure
\ref{rareLocPlot}).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rareLocDf <-}\StringTok{ }\KeywordTok{obsProb}\NormalTok{(}\DataTypeTok{occProb =} \FloatTok{0.001}\NormalTok{, }\DataTypeTok{detectProb =} \KeywordTok{seq}\NormalTok{(}\FloatTok{0.4}\NormalTok{, }\FloatTok{0.8}\NormalTok{, }\DataTypeTok{by =} \FloatTok{0.2}\NormalTok{), }
    \DataTypeTok{locations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{30}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{20}\NormalTok{), }\DataTypeTok{visits =} \KeywordTok{seq}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{16}\NormalTok{, }\DataTypeTok{by =} \DecValTok{4}\NormalTok{), }\DataTypeTok{visitCost =} \DecValTok{5000}\NormalTok{)}

\NormalTok{rareLocDf}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 588 x 7
##    occProb detectProb locations visits visitCost obsProb totCost
##      <dbl>      <dbl>     <dbl>  <dbl>     <dbl>   <dbl>   <dbl>
##  1 0.00100      0.400      30.0   4.00      5000  0.0257  600000
##  2 0.00100      0.600      30.0   4.00      5000  0.0288  600000
##  3 0.00100      0.800      30.0   4.00      5000  0.0295  600000
##  4 0.00100      0.400      50.0   4.00      5000  0.0425 1000000
##  5 0.00100      0.600      50.0   4.00      5000  0.0475 1000000
##  6 0.00100      0.800      50.0   4.00      5000  0.0487 1000000
##  7 0.00100      0.400      70.0   4.00      5000  0.0589 1400000
##  8 0.00100      0.600      70.0   4.00      5000  0.0659 1400000
##  9 0.00100      0.800      70.0   4.00      5000  0.0675 1400000
## 10 0.00100      0.400      90.0   4.00      5000  0.0750 1800000
## # ... with 578 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(rareLocDf, }\DataTypeTok{group =} \StringTok{"visits"}\NormalTok{, }\DataTypeTok{xVar =} \StringTok{"locations"}\NormalTok{, }\DataTypeTok{yVar =} \StringTok{"obsProb"}\NormalTok{, }\DataTypeTok{hline =} \FloatTok{0.8}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{facet_grid}\NormalTok{(occProb }\OperatorTok{~}\StringTok{ }\NormalTok{detectProb)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/rareLocPlot-1.png}
\caption{Probability of detecting a rare species (occurrence probability
= 0.001) as a function of the number of visited locations and visits per
location for different detection probabilities (detectProb = 0.4, 0.6,
and 0.8). \label{rareLocPlot}}
\end{figure}

In figure \ref{rareLocPlot}, we see that observing a very rare species
with a high certainty is difficult even with a very large number of
visited locations. In these cases, it doesn't really help to visit each
location many times, as the overall probability is limited by the number
of locations we visit. Figure \ref{rareVisitPlot} shows the results of
maximising the number of visits in fixed, but large number of locations,
for a very rare species.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rareVisitDf <-}\StringTok{ }\KeywordTok{obsProb}\NormalTok{(}\DataTypeTok{occProb =} \FloatTok{0.001}\NormalTok{, }\DataTypeTok{detectProb =} \KeywordTok{seq}\NormalTok{(}\FloatTok{0.2}\NormalTok{, }\FloatTok{0.8}\NormalTok{, }\DataTypeTok{by =} \FloatTok{0.2}\NormalTok{), }
    \DataTypeTok{locations =} \DecValTok{250}\NormalTok{, }\DataTypeTok{visits =} \KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DataTypeTok{by =} \DecValTok{5}\NormalTok{), }\DataTypeTok{visitCost =} \DecValTok{5000}\NormalTok{)}

\NormalTok{rareVisitDf}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 12 x 7
##    occProb detectProb locations visits visitCost obsProb  totCost
##      <dbl>      <dbl>     <dbl>  <dbl>     <dbl>   <dbl>    <dbl>
##  1 0.00100      0.200       250   1.00      5000  0.0443  1250000
##  2 0.00100      0.400       250   1.00      5000  0.0885  1250000
##  3 0.00100      0.600       250   1.00      5000  0.133   1250000
##  4 0.00100      0.800       250   1.00      5000  0.177   1250000
##  5 0.00100      0.200       250   6.00      5000  0.163   7500000
##  6 0.00100      0.400       250   6.00      5000  0.211   7500000
##  7 0.00100      0.600       250   6.00      5000  0.220   7500000
##  8 0.00100      0.800       250   6.00      5000  0.221   7500000
##  9 0.00100      0.200       250  11.0       5000  0.202  13750000
## 10 0.00100      0.400       250  11.0       5000  0.220  13750000
## 11 0.00100      0.600       250  11.0       5000  0.221  13750000
## 12 0.00100      0.800       250  11.0       5000  0.221  13750000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(rareVisitDf, }\DataTypeTok{group =} \StringTok{"detectProb"}\NormalTok{, }\DataTypeTok{xVar =} \StringTok{"visits"}\NormalTok{, }\DataTypeTok{yVar =} \StringTok{"obsProb"}\NormalTok{, }\DataTypeTok{titleVar =} \KeywordTok{c}\NormalTok{(}\StringTok{"occProb"}\NormalTok{, }
    \StringTok{"locations"}\NormalTok{), }\DataTypeTok{hline =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/rareVisitPlot-1.png}
\caption{Observation probability for surveying a very rare species as
function of sampled locations. \label{rareVisitPlot}}
\end{figure}

Although the overall cost increases linearly with the total number of
samples (figure \ref{rareCostPlot}), in cases with very rare species,
this doesn't mean that the overall detection probability continues to
increase indefinitely (figure \ref{rareVisitPlot})

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rareCostDf <-}\StringTok{ }\KeywordTok{obsProb}\NormalTok{(}\DataTypeTok{occProb =} \FloatTok{0.001}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.4}\NormalTok{, }\DataTypeTok{locations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{50}\NormalTok{, }
    \DecValTok{250}\NormalTok{, }\DataTypeTok{by =} \DecValTok{50}\NormalTok{), }\DataTypeTok{visits =} \KeywordTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{21}\NormalTok{, }\DataTypeTok{by =} \DecValTok{5}\NormalTok{), }\DataTypeTok{visitCost =} \DecValTok{5000}\NormalTok{)}

\NormalTok{rareCostDf}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 25 x 7
##    occProb detectProb locations visits visitCost obsProb totCost
##      <dbl>      <dbl>     <dbl>  <dbl>     <dbl>   <dbl>   <dbl>
##  1 0.00100      0.400      50.0   1.00      5000  0.0195  250000
##  2 0.00100      0.400     100     1.00      5000  0.0381  500000
##  3 0.00100      0.400     150     1.00      5000  0.0557  750000
##  4 0.00100      0.400     200     1.00      5000  0.0725 1000000
##  5 0.00100      0.400     250     1.00      5000  0.0885 1250000
##  6 0.00100      0.400      50.0   6.00      5000  0.0465 1500000
##  7 0.00100      0.400     100     6.00      5000  0.0908 3000000
##  8 0.00100      0.400     150     6.00      5000  0.133  4500000
##  9 0.00100      0.400     200     6.00      5000  0.173  6000000
## 10 0.00100      0.400     250     6.00      5000  0.211  7500000
## # ... with 15 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(rareCostDf, }\DataTypeTok{group =} \StringTok{"locations"}\NormalTok{, }\DataTypeTok{xVar =} \StringTok{"visits"}\NormalTok{, }\DataTypeTok{yVar =} \StringTok{"totCost"}\NormalTok{, }\DataTypeTok{titleVar =} \StringTok{"visitCost"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/rareCostPlot-1.png}
\caption{Total survey cost as a function of the total number of samples
\label{rareCostPlot}}
\end{figure}

\section{Some strategies}\label{some-strategies}

As seen in figure \ref{lowOccurrPlot}, when we deal with a very rare
species, it is little use increasing the number of visits to each
location (or to spend money maximizing the detection probability), if we
can't at the same time span a very large number of locations. We must in
these cases concentrate on increasing the number of visited locations.
Still, for a very rare species such as displayed in figure
\ref{lowOccurrPlot}, with an occurrence probability of 0.01\%, reaching
an overall observation probability of 80\% requires more at least 1650
locations, which would be unfeasible for most survey programs.

Alternatively, if detectability is low but presence is relatively high,
we should focus on increasing the number of revisits per location,
instead of trying to cover many locations (figure \ref{lowDetectPlot}).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lowOccurrDf <-}\StringTok{ }\KeywordTok{obsProb}\NormalTok{(}\DataTypeTok{occProb =} \FloatTok{0.001}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{locations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{50}\NormalTok{, }
    \DecValTok{2000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{50}\NormalTok{), }\DataTypeTok{visits =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\KeywordTok{seq}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DataTypeTok{by =} \DecValTok{5}\NormalTok{)), }\DataTypeTok{visitCost =} \DecValTok{5000}\NormalTok{)}

\NormalTok{lowOccurrDf}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 200 x 7
##    occProb detectProb locations visits visitCost obsProb totCost
##      <dbl>      <dbl>     <dbl>  <dbl>     <dbl>   <dbl>   <dbl>
##  1 0.00100      0.800      50.0   1.00      5000  0.0390  250000
##  2 0.00100      0.800     100     1.00      5000  0.0762  500000
##  3 0.00100      0.800     150     1.00      5000  0.111   750000
##  4 0.00100      0.800     200     1.00      5000  0.145  1000000
##  5 0.00100      0.800     250     1.00      5000  0.177  1250000
##  6 0.00100      0.800     300     1.00      5000  0.207  1500000
##  7 0.00100      0.800     350     1.00      5000  0.236  1750000
##  8 0.00100      0.800     400     1.00      5000  0.264  2000000
##  9 0.00100      0.800     450     1.00      5000  0.290  2250000
## 10 0.00100      0.800     500     1.00      5000  0.315  2500000
## # ... with 190 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(lowOccurrDf, }\DataTypeTok{group =} \StringTok{"visits"}\NormalTok{, }\DataTypeTok{xVar =} \StringTok{"locations"}\NormalTok{, }\DataTypeTok{yVar =} \StringTok{"obsProb"}\NormalTok{, }\DataTypeTok{titleVar =} \KeywordTok{c}\NormalTok{(}\StringTok{"occProb"}\NormalTok{, }
    \StringTok{"detectProb"}\NormalTok{), }\DataTypeTok{hline =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/lowOccurrPlot-1.png}
\caption{Observation probability for surveying a rare species as
function of sampled locations. \label{lowOccurrPlot}}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lowDetectDf <-}\StringTok{ }\KeywordTok{obsProb}\NormalTok{(}\DataTypeTok{occProb =} \FloatTok{0.05}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.2}\NormalTok{, }\DataTypeTok{locations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{50}\NormalTok{, }
    \DecValTok{250}\NormalTok{, }\DataTypeTok{by =} \DecValTok{50}\NormalTok{), }\DataTypeTok{visits =} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\KeywordTok{seq}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DataTypeTok{by =} \DecValTok{5}\NormalTok{)), }\DataTypeTok{visitCost =} \DecValTok{5000}\NormalTok{)}

\NormalTok{lowDetectDf}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 25 x 7
##    occProb detectProb locations visits visitCost obsProb totCost
##      <dbl>      <dbl>     <dbl>  <dbl>     <dbl>   <dbl>   <dbl>
##  1  0.0500      0.200      50.0   1.00      5000   0.185  250000
##  2  0.0500      0.200     100     1.00      5000   0.199  500000
##  3  0.0500      0.200     150     1.00      5000   0.200  750000
##  4  0.0500      0.200     200     1.00      5000   0.200 1000000
##  5  0.0500      0.200     250     1.00      5000   0.200 1250000
##  6  0.0500      0.200      50.0   5.00      5000   0.621 1250000
##  7  0.0500      0.200     100     5.00      5000   0.668 2500000
##  8  0.0500      0.200     150     5.00      5000   0.672 3750000
##  9  0.0500      0.200     200     5.00      5000   0.672 5000000
## 10  0.0500      0.200     250     5.00      5000   0.672 6250000
## # ... with 15 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(lowDetectDf, }\DataTypeTok{group =} \StringTok{"visits"}\NormalTok{, }\DataTypeTok{xVar =} \StringTok{"locations"}\NormalTok{, }\DataTypeTok{yVar =} \StringTok{"obsProb"}\NormalTok{, }\DataTypeTok{titleVar =} \KeywordTok{c}\NormalTok{(}\StringTok{"occProb"}\NormalTok{, }
    \StringTok{"detectProb"}\NormalTok{), }\DataTypeTok{hline =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/lowDetectPlot-1.png}
\caption{Observation probability for surveying a cryptic species as
function of sampled locations. \label{lowDetectPlot}}
\end{figure}

\section{Plausible values}\label{plausible-values}

It is difficult to guess plausible values for occurrence and
detectability for real world species, but it is reasonable to assume
that we only have to consider rather low occurrence probabilities, since
we are working on early detections. We can explore our possibilities of
observing a species that occurr in between 0.1 to 1\% of all studied
locations. We can set the number of locations to 100 and with two
visits, as a reasonable possibility.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{guessDf <-}\StringTok{ }\KeywordTok{obsProb}\NormalTok{(}\DataTypeTok{occProb =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.001}\NormalTok{, }\FloatTok{0.005}\NormalTok{, }\FloatTok{0.01}\NormalTok{, }\FloatTok{0.02}\NormalTok{, }\FloatTok{0.04}\NormalTok{, }\FloatTok{0.05}\NormalTok{, }\FloatTok{0.1}\NormalTok{), }\DataTypeTok{detectProb =} \KeywordTok{c}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }
    \KeywordTok{seq}\NormalTok{(}\FloatTok{0.2}\NormalTok{, }\FloatTok{0.8}\NormalTok{, }\DataTypeTok{by =} \FloatTok{0.2}\NormalTok{)), }\DataTypeTok{locations =} \KeywordTok{c}\NormalTok{(}\DecValTok{50}\NormalTok{, }\KeywordTok{seq}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{300}\NormalTok{, }\DataTypeTok{by =} \DecValTok{100}\NormalTok{)), }\DataTypeTok{visits =} \KeywordTok{seq}\NormalTok{(}\DecValTok{2}\NormalTok{, }
    \DecValTok{6}\NormalTok{, }\DataTypeTok{by =} \DecValTok{2}\NormalTok{), }\DataTypeTok{visitCost =} \DecValTok{5000}\NormalTok{)}

\NormalTok{guessDf}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 420 x 7
##    occProb detectProb locations visits visitCost obsProb totCost
##      <dbl>      <dbl>     <dbl>  <dbl>     <dbl>   <dbl>   <dbl>
##  1 0.00100      0.100      50.0   2.00      5000 0.00927  500000
##  2 0.00500      0.100      50.0   2.00      5000 0.0421   500000
##  3 0.0100       0.100      50.0   2.00      5000 0.0750   500000
##  4 0.0200       0.100      50.0   2.00      5000 0.121    500000
##  5 0.0400       0.100      50.0   2.00      5000 0.165    500000
##  6 0.0500       0.100      50.0   2.00      5000 0.175    500000
##  7 0.100        0.100      50.0   2.00      5000 0.189    500000
##  8 0.00100      0.200      50.0   2.00      5000 0.0176   500000
##  9 0.00500      0.200      50.0   2.00      5000 0.0798   500000
## 10 0.0100       0.200      50.0   2.00      5000 0.142    500000
## # ... with 410 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(guessDf, }\DataTypeTok{group =} \StringTok{"detectProb"}\NormalTok{, }\DataTypeTok{xVar =} \StringTok{"occProb"}\NormalTok{, }\DataTypeTok{yVar =} \StringTok{"obsProb"}\NormalTok{, }\DataTypeTok{hline =} \FloatTok{0.8}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{facet_grid}\NormalTok{(visits }\OperatorTok{~}\StringTok{ }\NormalTok{locations) }\OperatorTok{+}\StringTok{ }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{5}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/guessPlot-1.png}
\caption{Observation probability for a plausible range of values. The
plots are divided by number of sample locations in columns, and by
number of visits in rows.}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(guessDf, }\DataTypeTok{group =} \StringTok{"detectProb"}\NormalTok{, }\DataTypeTok{xVar =} \StringTok{"occProb"}\NormalTok{, }\DataTypeTok{yVar =} \StringTok{"obsProb"}\NormalTok{, }\DataTypeTok{hline =} \FloatTok{0.8}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{facet_grid}\NormalTok{(visits }\OperatorTok{~}\StringTok{ }\NormalTok{locations) }\OperatorTok{+}\StringTok{ }\KeywordTok{scale_y_log10}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{scale_x_log10}\NormalTok{() }\OperatorTok{+}\StringTok{ }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{axis.text.x =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \DecValTok{6}\NormalTok{)) }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{ylab}\NormalTok{(}\StringTok{"Observasjonssannsynlighet"}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Forekomstsannsynlighet"}\NormalTok{) }\OperatorTok{+}\StringTok{ }\KeywordTok{guides}\NormalTok{(}\DataTypeTok{color =} \KeywordTok{guide_legend}\NormalTok{(}\DataTypeTok{title =} \StringTok{"Pdeteksjon"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/guessPlotLog-1.png}
\caption{Observation probability for a plausible range of values. The
plots are divided by number of sample locations in columns, and by
number of visits in rows. Note the logarithmic scale.
\label{guessPlotLog}}
\end{figure}

\section{Unequally distributed
probabilities}\label{unequally-distributed-probabilities}

** There is no definition for early detection. The earlier we want to
detect (no occurrences is low) the more costly to detect. We can use the
alien/native map as a relative risk map and use that to ``model'' a
weighted occurrence map. This we visit in a weighted fashion as well, a
number of times. Need to work out the math. We can then calculate the
costs for different number of alien occurrences.**

In the equation
\(probObserv = (1 - (1 - \psi)^J) * (1 - (1 - \theta)^K))\), \(\psi\)
designates the probability that a site we visit contains a certain
species. So far, we have only considered situations where the occurrence
probabilities (\(\psi\)) are the same for all sites. In reality,
however, the probability that a specific site that you visit contains a
certain species will vary between sites. It will depend both on the
probability of a site containing a species, and the probability that you
visit that site. We can view the probability of a specific site
containing a species as a weighted sampling without replacement. For
example, if we know there are a 100 sites containing species x, we can
calculate the probability that each site contains species x if we know
the probability weights. This probability can be written, following
Eframidis \& Spirakis 2006,as
\(p_i(k) = \frac{w_i} {\sum_{S_j \in V - S} {w_j}}\). For brevity,
however, we will simply designate this probability as \(Pr[w_i, n]\),
where the weights \(w_i\) sums to 1, and \(n\) is the number of sites
with the species. Similarly, we choose which sites to visit as a
sampling without replacement, so that the probability of visiting a site
\(i\) is \(Pr[u_i, v]\), where \(u_i\) is the visitation weights, which
sums to 1, and \(v\) is the number of sites you visit. The probability
of visiting a site with an alien species then becomes
\(\psi_i = Pr[w_i, n] * Pr[u_i, v]\), and the probability of visiting
any location inhabited by an alien species is
\(PoccurrVisit = (1 - \prod_{i}^{}(1 - (Pr[w_i, n] * Pr[u_i, v])))\).

For simplicity, we can assume that the probability of detection is equal
for each site and visit. The probability of detecting an alien species
is then
\(Pdetect = (1 - \prod_{i}^{}(1 - (Pr[w_i, n] * Pr[u_i, v]))) * (1 - (1 - d)^K\),
where d is the detection probability, and K is again the number of
visits per site.

In the best of worlds, \(w_i\) and \(u_i\) would match up well, so that
we visit the most likely sites to contain a species of interest. The
overall probability of detection will decrease as the difference between
these variables increase, or in simpler terms we visit the wrong places.
Also, the probability will go down the more spread out the probability
weights are. In the extreme case, with no spread in these probabilities,
there is 100 \% certainty that a species will be present in location 1,
and 100 \% certainty that we will visit just that. In this case, the
probabilities are 1 for both occurrence and visitation, so that we are
certain we visit a site with a presence. In the other end, there might
be no information in the weights, so that the occurrences are randomly
spread out, and we visit random sites. In that case, \(w_i\) are all the
same and \(u_i\) are all the same, and we end up with the first
equation.

In reality, we don't know the true weights that the sites will contain a
specific species, and we might choose to visit the wrong sites. For this
example calculation, we will assume we know the occurrence weights, and
visit them accordingly. In other words, that \(w_i = u_i\). If we
stipulate the desired detection probability (at e.g 0.8), we can
calculate how many sites \(v\) we need to visit to be able to detect a
species that occurr in \(n\) sites with weighted probabilities \(w_i\),
with a specific certainty.

So far, the best estimate for the occurrence weights are the occurrence
modelling of alien vascular plants from Olsen et al. 2017. Using this as
input, and some simple assumptions, we can calculate the needed number
of sites.

To get test it out, we can use the 10km scale, which isn't so resource
intensive. The 1km scale isn't really interactive since it takes to long
time to calculate.

For now, we get rid of the geometry column to increase speed.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predWeights <-}\StringTok{ }\NormalTok{predMap }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{(}\DataTypeTok{sites =}\NormalTok{ ssbid, }\DataTypeTok{weights =}\NormalTok{ pred) }\OperatorTok{%>%}\StringTok{ }\NormalTok{sf}\OperatorTok{::}\KeywordTok{st_set_geometry}\NormalTok{(}\OtherTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

But we start with a situation where the occupied patches are distributed
randomly, and we visit the sites randomly. In other words, where the
occurrence and visitation weights all are equal.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predWeightsZero <-}\StringTok{ }\NormalTok{predWeights}
\NormalTok{predWeightsZero}\OperatorTok{$}\NormalTok{weights <-}\StringTok{ }\DecValTok{1}


\KeywordTok{system.time}\NormalTok{(predProb50Zero <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ predWeightsZero, }
    \DataTypeTok{visWeights =}\NormalTok{ predWeights, }\DataTypeTok{noOccur =} \DecValTok{5}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{50}\NormalTok{, }\DecValTok{200}\NormalTok{, }\DataTypeTok{by =} \DecValTok{50}\NormalTok{), }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{1}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    user  system elapsed 
##   2.717   0.000   2.717
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predProb50Zero}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
##   noLocations probObs
##         <dbl>   <dbl>
## 1        50.0  0.0691
## 2       100    0.142 
## 3       150    0.143 
## 4       200    0.219
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predProb50Zero, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/predProb50Zero-1.png} We can see that the
probability of visiting a randomly occupied cell in this case starts
from about 0.07 and approaches 0.2 as we increase our number of visited
locations from 50 to 200. We can quality check this with a simpler
function.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(}\DataTypeTok{noOccur =} \DecValTok{50}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{5}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{) \{}
    
\NormalTok{    prop <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(}\DataTypeTok{noLocations. =}\NormalTok{ noLocations, }\DataTypeTok{noOccur. =}\NormalTok{ noOccur) \{}
\NormalTok{        visited <-}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{4057}\NormalTok{, noLocations., }\DataTypeTok{replace =}\NormalTok{ F)  }\CommentTok{#number of 10km cells}
\NormalTok{        occupied <-}\StringTok{ }\KeywordTok{sample}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{4057}\NormalTok{, noOccur, }\DataTypeTok{replace =}\NormalTok{ F)}
        
        \KeywordTok{any}\NormalTok{(visited }\OperatorTok{%in%}\StringTok{ }\NormalTok{occupied)}
\NormalTok{    \}}
    
    
    \KeywordTok{sum}\NormalTok{(}\KeywordTok{replicate}\NormalTok{(nIter, }\KeywordTok{prop}\NormalTok{())}\OperatorTok{/}\NormalTok{nIter)}
\NormalTok{\}}



\KeywordTok{test}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.05505506
\end{verbatim}

We get the same results if the occurrence probabilities is distributed
according to informative weights, and only the visitations are random
(not shown).

But what happens when we have information about the occurence of the
species? In effect, we limit the number of potential sites we visit to a
smaller value, which have higher probability of housing the species. We
use the prediction map to set the occurrences, and visitation
probabilities. We continue with the detection probability set to 1, with
just 1 visit per site.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{system.time}\NormalTok{(predProb <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ predWeights, }\DataTypeTok{visWeights =}\NormalTok{ predWeights, }
    \DataTypeTok{noOccur =} \DecValTok{5}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{50}\NormalTok{, }\DecValTok{200}\NormalTok{, }\DataTypeTok{by =} \DecValTok{50}\NormalTok{), }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{1}\NormalTok{, }
    \DataTypeTok{nIter =} \DecValTok{999}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    user  system elapsed 
##   3.703   0.004   3.708
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predProb}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 2
##   noLocations probObs
##         <dbl>   <dbl>
## 1        50.0   0.399
## 2       100     0.644
## 3       150     0.804
## 4       200     0.878
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predProb, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/predProb-1.png}
\caption{50 out of 4057 grid cells occupied according to weights, 1
visit with 1 detection probability}
\end{figure}

We then reach quite high probabilities for observing the species. This
of course depend on the quality of the predictions, i.e.~our weights.
This prediction map is actually quite informative. From the histogram of
weights, we can see that a small number of sites have a proportionally
high weight. This limits the realised occurrences quite a bit.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(predWeights}\OperatorTok{$}\NormalTok{weights)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/unnamed-chunk-14-1.png}

\subsection{Calculations based on 1km
map}\label{calculations-based-on-1km-map}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{require}\NormalTok{(RPostgreSQL)}
\KeywordTok{require}\NormalTok{(DBI)}
\KeywordTok{require}\NormalTok{(rpostgis)}
\KeywordTok{require}\NormalTok{(SurveyPower)}
\KeywordTok{require}\NormalTok{(tidyverse)}
\KeywordTok{data}\NormalTok{(map1km)}


\NormalTok{con <-}\StringTok{ }\KeywordTok{dbConnect}\NormalTok{(RPostgreSQL}\OperatorTok{::}\KeywordTok{PostgreSQL}\NormalTok{(), }\DataTypeTok{host =} \StringTok{"gisdata-db.nina.no"}\NormalTok{, }\DataTypeTok{dbname =} \StringTok{"gisdata"}\NormalTok{, }
    \DataTypeTok{user =} \StringTok{"postgjest"}\NormalTok{, }\DataTypeTok{password =} \StringTok{"gjestpost"}\NormalTok{)}
\CommentTok{# pred <- pgGetRast(con, name = c('hotspot_ias', 'bigPred1km'), rast =}
\CommentTok{# 'rast', bands = 1, boundary = NULL)}

\NormalTok{predQ <-}\StringTok{ "SELECT ssbid, ST_Value(pred.rast, ST_Centroid(ssb.geom)) pred}
\StringTok{FROM ssb_data_utm33n.ssb_1km ssb,}
\StringTok{hotspot_ias.}\CharTok{\textbackslash{}"}\StringTok{evenintbigpred1km}\CharTok{\textbackslash{}"}\StringTok{ pred}
\StringTok{WHERE ST_Intersects(ssb.geom, pred.rast)}
\StringTok{"}

\NormalTok{pred <-}\StringTok{ }\KeywordTok{dbGetQuery}\NormalTok{(con, predQ)}

\NormalTok{pred <-}\StringTok{ }\NormalTok{pred }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{ssbid =} \KeywordTok{as.character}\NormalTok{(ssbid))}

\NormalTok{predMap1km <-}\StringTok{ }\NormalTok{map1km }\OperatorTok{%>%}\StringTok{ }\KeywordTok{left_join}\NormalTok{(pred, }\DataTypeTok{by =} \KeywordTok{c}\NormalTok{(}\DataTypeTok{ssbid =} \StringTok{"ssbid"}\NormalTok{))}

\NormalTok{predMap1km}\OperatorTok{$}\NormalTok{pred[}\KeywordTok{is.na}\NormalTok{(predMap1km}\OperatorTok{$}\NormalTok{pred)] <-}\StringTok{ }\DecValTok{0}

\CommentTok{# plot(predMap1km['pred']) #Slow}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predWeights1km <-}\StringTok{ }\NormalTok{predMap1km }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{(}\DataTypeTok{sites =}\NormalTok{ ssbid, }\DataTypeTok{weights =}\NormalTok{ pred) }\OperatorTok{%>%}\StringTok{ }\NormalTok{sf}\OperatorTok{::}\KeywordTok{st_set_geometry}\NormalTok{(}\OtherTok{NULL}\NormalTok{)}

\NormalTok{devtools}\OperatorTok{::}\KeywordTok{use_data}\NormalTok{(predWeights1km)}
\end{Highlighting}
\end{Shaded}

Since we now have about 100 times as many potential sites, we would need
to increase the occurrences accordingly. But while 50 out of 4057
10x10km squares sounds reasonable for an ``early'' detection,
multiplying this with 100 yields 5000 locations in a 1x1km grid. This
sounds like a lot for an early detection. But it puts the 50 occurrences
above into perspective. Surveying 10x10km cells with good detection
probability is a tall order.

For the 1x1km analysis, the calculations takes to much time to do on the
fly, so we pre-calculate them and load the results.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{data}\NormalTok{(}\StringTok{"predWeights1km"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

It is reasonable to assume that we won't reach a higher detection
probability than 0.8 for a single visit, and even that is probably high
for a truly novel species. But we can explore the range of occupied
sites that are reasonable to handle with such a good detection
probability.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{system.time}\NormalTok{(predOcc500Det0.}\DecValTok{8}\NormalTok{ <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ predWeights1km, }
    \DataTypeTok{visWeights =}\NormalTok{ predWeights1km, }\DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{50}\NormalTok{, }\DecValTok{300}\NormalTok{, }\DataTypeTok{by =} \DecValTok{50}\NormalTok{), }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{))}

\KeywordTok{save}\NormalTok{(predOcc500Det0.}\DecValTok{8}\NormalTok{, }\DataTypeTok{file =} \StringTok{"predOcc500Det0.8.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\DataTypeTok{file =} \StringTok{"predOcc500Det0.8.Rdata"}\NormalTok{)}
\NormalTok{predOcc500Det0.}\DecValTok{8}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 2
##   noLocations probObs
##         <dbl>   <dbl>
## 1        50.0   0.343
## 2       100     0.538
## 3       150     0.691
## 4       200     0.798
## 5       250     0.866
## 6       300     0.913
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predOcc500Det0.}\DecValTok{8}\NormalTok{, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/predOcc500Det0.8-1.png}
\caption{Estimated observation probability of an alien vascular plant
species occurring in 500 1x1km grid cells as a function of the number of
visited locations. Occurrences and location selection is based on the
same weights, modelled from actual alien vascular plant species
occurrences. Each visit has a 0.8 probability of detecting the species
if present. The threshold of the desired observation probabilitiy of 0.8
is shown as a dashed line. \label{predOcc500Det0.8}}
\end{figure}

So for the case of 500 occupied cells, we reach the target observation
probability after visiting about 200 sites. In similar fashion, we can
explore the case with 200 and 100 occupied cells, respectively.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{system.time}\NormalTok{(predOcc200Det0.}\DecValTok{8}\NormalTok{ <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ predWeights1km, }
    \DataTypeTok{visWeights =}\NormalTok{ predWeights1km, }\DataTypeTok{noOccur =} \DecValTok{200}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{50}\NormalTok{, }\DecValTok{600}\NormalTok{, }\DataTypeTok{by =} \DecValTok{50}\NormalTok{), }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{))}

\KeywordTok{save}\NormalTok{(predOcc200Det0.}\DecValTok{8}\NormalTok{, }\DataTypeTok{file =} \StringTok{"predOcc200Det0.8.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\DataTypeTok{file =} \StringTok{"predOcc200Det0.8.Rdata"}\NormalTok{)}
\KeywordTok{xtable}\NormalTok{(predOcc200Det0.}\DecValTok{8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}[ht]
\centering
\begin{tabular}{rr}
  \hline
noLocations & probObs \\ 
  \hline
50.00 & 0.13 \\ 
  100.00 & 0.28 \\ 
  150.00 & 0.40 \\ 
  200.00 & 0.48 \\ 
  250.00 & 0.52 \\ 
  300.00 & 0.63 \\ 
  350.00 & 0.68 \\ 
  400.00 & 0.73 \\ 
  450.00 & 0.76 \\ 
  500.00 & 0.81 \\ 
  550.00 & 0.83 \\ 
  600.00 & 0.88 \\ 
   \hline
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predOcc200Det0.}\DecValTok{8}\NormalTok{, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/predOcc200Det0.8-1.png}
\caption{Estimated observation probability of an alien vascular plant
species occurring in 200 1x1km grid cells as a function of the number of
visited locations. Occurrences and location selection is based on the
same weights, modelled from actual alien vascular plant species
occurrences. Each visit has a 0.8 probability of detecting the species
if present. The threshold of the desired observation probabilitiy of 0.8
is shown as a dashed line. \label{predOcc200Det0.8}}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{system.time}\NormalTok{(predOcc100Det0.}\DecValTok{8}\NormalTok{ <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ predWeights1km, }
    \DataTypeTok{visWeights =}\NormalTok{ predWeights1km, }\DataTypeTok{noOccur =} \DecValTok{100}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{50}\NormalTok{, }\DecValTok{600}\NormalTok{, }\DataTypeTok{by =} \DecValTok{50}\NormalTok{), }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{))}

\KeywordTok{save}\NormalTok{(predOcc100Det0.}\DecValTok{8}\NormalTok{, }\DataTypeTok{file =} \StringTok{"predOcc100Det0.8.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\DataTypeTok{file =} \StringTok{"predOcc100Det0.8.Rdata"}\NormalTok{)}

\KeywordTok{xtable}\NormalTok{(predOcc100Det0.}\DecValTok{8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}[ht]
\centering
\begin{tabular}{rr}
  \hline
noLocations & probObs \\ 
  \hline
50.00 & 0.09 \\ 
  100.00 & 0.15 \\ 
  150.00 & 0.22 \\ 
  200.00 & 0.26 \\ 
  250.00 & 0.31 \\ 
  300.00 & 0.37 \\ 
  350.00 & 0.39 \\ 
  400.00 & 0.46 \\ 
  450.00 & 0.53 \\ 
  500.00 & 0.58 \\ 
  550.00 & 0.61 \\ 
  600.00 & 0.62 \\ 
   \hline
\end{tabular}
\end{table}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predOcc100Det0.}\DecValTok{8}\NormalTok{, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/predOcc100Det0.8-1.png} In the case of 200
occupied cells, we reach an overall observation probability of 0.8 after
about 500 visited sites with an observation probability of 0.8. With
only 100 occupied cells, we don't reach the target of 0.8 even after 600
visited locations.

We can see the effect of a lower detection probability.

\subsection{Surveying 250x250m
squares}\label{surveying-250x250m-squares}

In practice, it can be challenging to survey even a 1x1km grid with any
respectable observation probability. We might therefore subdivide the
squares in smaller units, with the result that our detection probability
decreases from simply not covering the place where the species occupies.
If a species just occurs in one out of 16 250x250 squares within a 1x1km
square and we visit only one such smaller square, our detection
probability drops to 1/16 of the former level. How much the detection
probability drops of course depend on the aggregation pattern of the
species, i.e.~how much of the 1x1km cell it is present in. On a tangent,
the number of occurrences we consider to be acceptable within an ``early
detection'' framework depends on the scale of the grid cells considered,
and the way that the species are aggregated. 500 out of ca 50 000 1x1km
cells constitutes occurrences in 1\% of the cells. If we accept a 1\%
occurrence in the about 800 000 250x250 cells, that amounts to 8000
occurrences. As long as these are not extremy aggregated, this could
hardly be seen as an early establishment phase.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc500Det0.05.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc500Det0.05Vis4.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc500Det0.05Vis10.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc500Det0.025Vis4.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc500Det0.025Vis10.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc100Det0.05Vis10.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc100Det0.05Vis4.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc100Det0.05Vis1.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc500Det0.2.Rdata"}\NormalTok{)}
\KeywordTok{load}\NormalTok{(}\StringTok{"predOcc500Det0.5.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{Case of 500 1x1km cells occupied, but we survey only
250x250m
subsquares}\label{case-of-500-1x1km-cells-occupied-but-we-survey-only-250x250m-subsquares}

We start with the case of 500 occurrences spread out in the 50 000 1x1km
cells, but when we visit just a 16th of these cells once.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predOcc500Det0.}\DecValTok{05}\NormalTok{, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/predOcc500Det0.05-1.png}
\caption{Probability of detecting a species at least once that is
present in 500 of the 1x1km cells, but we survey only a 1/16 of the
cell.}
\end{figure}

It is clear that these conditions does not let us reach the desired
detection probability of 0.8 even with a great number of sampled
locations.

We can continue to explore the possibilities with a lower total
occurrence, for example when a species is present in 100 out of the 50
000 1x1km grid cells.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predOcc100Det0.05Vis1, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/predOcc100Det0.05-1.png}
\caption{Probability of detecting a species at least once that is
present in 100 of the 1x1km cells, but1 we survey only a 1/16 of the
cell.}
\end{figure}

This situation leaves us with very slim chances of detecting the
species.

We can mitigate these low numbers by surveying the same 1x1km square
multiple times. Note that I here assume that the species is stationary
in only one place, and we return to different subplots within the 1x1km
square, so that we cover an increasing portion of the sample location.
The detectability thus increases linearly. For example, if we have a
detection probability of 0.8 in a given location, but we only visit 10
1/16th of that location, we get a detection probability of
0.8/16\emph{10 = 0.5. If we would instead visit 2 subsquares of 1/16, we
would get 0.8/16}4 = 0.2

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predOcc500Det0.}\DecValTok{5}\NormalTok{, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/predOcc500Det0.5Vis-1.png}
\caption{Probability of detecting a species at least once that is
present in 500 of the 1x1km cells, but we survey 10 1/16th of the cell.
Here we visit the 1x1km cell 10 times.}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(predOcc500Det0.}\DecValTok{2}\NormalTok{, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/predOcc500Det0.2Vis-1.png}
\caption{Probability of detecting a species at least once that is
present in 500 of the 1x1km cells, but we survey 4 1/16th of the cell.
Here we visit the 1x1km cell 10 times.}
\end{figure}

\subsection{Surveys limited to a specific
area}\label{surveys-limited-to-a-specific-area}

One strategy is to limit the surveyed areas to focus the efforts. We may
thereby increase our chances to visit a location that is occupied by a
rare species, but we also cannot find species that are not present in
the area of interest.

This situation can be modelled using the same function
\texttt{weightedDetection}, by setting the visitation probability to
zero for the locations outside our focus area. Based on the prediction
map, I have selected a set of kommunes around Oslo that seems to
encompass the areas with highest predictions.

\subsection{Oslo region}\label{oslo-region}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{occWeights <-}\StringTok{ }\NormalTok{predWeights1km}

\NormalTok{osloArea <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Vestby"}\NormalTok{, }\StringTok{"Svelvik"}\NormalTok{, }\StringTok{"Lørenskog"}\NormalTok{, }\StringTok{"Frogn"}\NormalTok{, }\StringTok{"Ås"}\NormalTok{, }\StringTok{"Skedsmo"}\NormalTok{, }
    \StringTok{"Oppegård"}\NormalTok{, }\StringTok{"Ski"}\NormalTok{, }\StringTok{"Hobøl"}\NormalTok{, }\StringTok{"Spydeberg"}\NormalTok{, }\StringTok{"Sande"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Bærum"}\NormalTok{, }\StringTok{"Asker"}\NormalTok{, }
    \StringTok{"Lier"}\NormalTok{, }\StringTok{"Øvre Eiker"}\NormalTok{, }\StringTok{"Nedre Eiker"}\NormalTok{, }\StringTok{"Drammen"}\NormalTok{, }\StringTok{"Hof"}\NormalTok{, }\StringTok{"Holmestrand"}\NormalTok{, }\StringTok{"Nesodden"}\NormalTok{, }
    \StringTok{"Frogn"}\NormalTok{, }\StringTok{"Røyken"}\NormalTok{)}

\NormalTok{osloAreaKommuneNr <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"0211"}\NormalTok{, }\StringTok{"0711"}\NormalTok{, }\StringTok{"0230"}\NormalTok{, }\StringTok{"0215"}\NormalTok{, }\StringTok{"0214"}\NormalTok{, }\StringTok{"0231"}\NormalTok{, }\StringTok{"0217"}\NormalTok{, }
    \StringTok{"0213"}\NormalTok{, }\StringTok{"0138"}\NormalTok{, }\StringTok{"0123"}\NormalTok{, }\StringTok{"0713"}\NormalTok{, }\StringTok{"0301"}\NormalTok{, }\StringTok{"0219"}\NormalTok{, }\StringTok{"0220"}\NormalTok{, }\StringTok{"0626"}\NormalTok{, }\StringTok{"0624"}\NormalTok{, }
    \StringTok{"0625"}\NormalTok{, }\StringTok{"0602"}\NormalTok{, }\StringTok{"0714"}\NormalTok{, }\StringTok{"0702"}\NormalTok{, }\StringTok{"0216"}\NormalTok{, }\StringTok{"0215"}\NormalTok{, }\StringTok{"0627"}\NormalTok{)}

\NormalTok{ssbidToVisit <-}\StringTok{ }\NormalTok{map1km }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(KOMMUNENUMMER }\OperatorTok{%in%}\StringTok{ }\NormalTok{osloAreaKommuneNr) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{select}\NormalTok{(ssbid, kommune)}


\KeywordTok{plot}\NormalTok{(ssbidToVisit[}\StringTok{"kommune"}\NormalTok{], }\DataTypeTok{key.width =} \KeywordTok{lcm}\NormalTok{(}\DecValTok{4}\NormalTok{), }\DataTypeTok{key.pos =} \DecValTok{4}\NormalTok{, }\DataTypeTok{border =} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/unnamed-chunk-25-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{osloVisWeights <-}\StringTok{ }\NormalTok{occWeights}
\NormalTok{osloVisWeights}\OperatorTok{$}\NormalTok{weights[}\OperatorTok{!}\NormalTok{(osloVisWeights}\OperatorTok{$}\NormalTok{sites }\OperatorTok{%in%}\StringTok{ }\NormalTok{ssbidToVisit}\OperatorTok{$}\NormalTok{ssbid)] <-}\StringTok{ }\DecValTok{0}
\KeywordTok{summary}\NormalTok{(osloVisWeights}\OperatorTok{$}\NormalTok{weights)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000000 0.0000000 0.0000000 0.0003481 0.0000000 3.0014784
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(occWeights}\OperatorTok{$}\NormalTok{weights)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000000 0.0000000 0.0000064 0.0089409 0.0041522 3.0014784
\end{verbatim}

\subsection{Bergen}\label{bergen}

One of several possible demarcations of ``Bergen area''

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bergenKommuneNr <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"1265"}\NormalTok{, }\StringTok{"1259"}\NormalTok{, }\StringTok{"1253"}\NormalTok{, }\StringTok{"1260"}\NormalTok{, }\StringTok{"1263"}\NormalTok{, }\StringTok{"1251"}\NormalTok{, }\StringTok{"1411"}\NormalTok{, }
    \StringTok{"1252"}\NormalTok{, }\StringTok{"1256"}\NormalTok{, }\StringTok{"1266"}\NormalTok{, }\StringTok{"1264"}\NormalTok{, }\StringTok{"1242"}\NormalTok{, }\StringTok{"1247"}\NormalTok{, }\StringTok{"1201"}\NormalTok{, }\StringTok{"1243"}\NormalTok{, }\StringTok{"1246"}\NormalTok{, }
    \StringTok{"1245"}\NormalTok{)}

\NormalTok{ssbidBergen <-}\StringTok{ }\NormalTok{map1km }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(KOMMUNENUMMER }\OperatorTok{%in%}\StringTok{ }\NormalTok{bergenKommuneNr) }\OperatorTok{%>%}\StringTok{ }\KeywordTok{select}\NormalTok{(ssbid, }
\NormalTok{    kommune)}


\KeywordTok{plot}\NormalTok{(ssbidBergen[}\StringTok{"kommune"}\NormalTok{], }\DataTypeTok{key.width =} \KeywordTok{lcm}\NormalTok{(}\DecValTok{4}\NormalTok{), }\DataTypeTok{key.pos =} \DecValTok{4}\NormalTok{, }\DataTypeTok{border =} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/unnamed-chunk-27-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bergenVisWeights <-}\StringTok{ }\NormalTok{occWeights}
\NormalTok{bergenVisWeights}\OperatorTok{$}\NormalTok{weights[}\OperatorTok{!}\NormalTok{(bergenVisWeights}\OperatorTok{$}\NormalTok{sites }\OperatorTok{%in%}\StringTok{ }\NormalTok{ssbidBergen}\OperatorTok{$}\NormalTok{ssbid)] <-}\StringTok{ }\DecValTok{0}
\KeywordTok{summary}\NormalTok{(bergenVisWeights}\OperatorTok{$}\NormalTok{weights)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000000 0.0000000 0.0000000 0.0004596 0.0000000 0.5579212
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(occWeights}\OperatorTok{$}\NormalTok{weights)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000000 0.0000000 0.0000064 0.0089409 0.0041522 3.0014784
\end{verbatim}

\subsection{Trondheim}\label{trondheim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{trondheimKommuneNr <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"1638"}\NormalTok{, }\StringTok{"1657"}\NormalTok{, }\StringTok{"1636"}\NormalTok{, }\StringTok{"1664"}\NormalTok{, }\StringTok{"1662"}\NormalTok{, }\StringTok{"1601"}\NormalTok{, }\StringTok{"1663"}\NormalTok{, }
    \StringTok{"1714"}\NormalTok{, }\StringTok{"1653"}\NormalTok{)}


\NormalTok{ssbidTrondheim <-}\StringTok{ }\NormalTok{map1km }\OperatorTok{%>%}\StringTok{ }\KeywordTok{filter}\NormalTok{(KOMMUNENUMMER }\OperatorTok{%in%}\StringTok{ }\NormalTok{trondheimKommuneNr) }\OperatorTok{%>%}\StringTok{ }
\StringTok{    }\KeywordTok{select}\NormalTok{(ssbid, kommune)}


\KeywordTok{plot}\NormalTok{(ssbidTrondheim[}\StringTok{"kommune"}\NormalTok{], }\DataTypeTok{key.width =} \KeywordTok{lcm}\NormalTok{(}\DecValTok{4}\NormalTok{), }\DataTypeTok{key.pos =} \DecValTok{4}\NormalTok{, }\DataTypeTok{border =} \DecValTok{0}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{figure/unnamed-chunk-29-1.png}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{trondheimVisWeights <-}\StringTok{ }\NormalTok{occWeights}
\NormalTok{trondheimVisWeights}\OperatorTok{$}\NormalTok{weights[}\OperatorTok{!}\NormalTok{(trondheimVisWeights}\OperatorTok{$}\NormalTok{sites }\OperatorTok{%in%}\StringTok{ }\NormalTok{ssbidTrondheim}\OperatorTok{$}\NormalTok{ssbid)] <-}\StringTok{ }\DecValTok{0}
\KeywordTok{summary}\NormalTok{(trondheimVisWeights}\OperatorTok{$}\NormalTok{weights)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000000 0.0000000 0.0000000 0.0002464 0.0000000 0.3133284
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(occWeights}\OperatorTok{$}\NormalTok{weights)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000000 0.0000000 0.0000064 0.0089409 0.0041522 3.0014784
\end{verbatim}

Run calculations

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{oslo47Sites <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo47Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo100Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{oslo66Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo200Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo140Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{## Bergen}
\NormalTok{bergen47Sites <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen47Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen100Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{bergen66Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen200Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen140Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}




\NormalTok{## Trondheim}

\NormalTok{trondheim47Sites <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim47Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim100Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{trondheim66Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim200Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim140Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge140Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\CommentTok{# Norge}
\NormalTok{norge47Sites <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge47Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge100Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{norge66Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge200Sites16 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}



\NormalTok{## small expensive 2 visits, 1.5 detection prob}

\NormalTok{norge50Sites16Vis2 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo50Sites16Vis2 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{bergen50Sites16Vis2 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{trondheim50Sites16Vis2 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\KeywordTok{save}\NormalTok{(oslo47Sites, oslo47Sites16, oslo66Sites16, oslo100Sites16, oslo140Sites16, }
\NormalTok{    oslo200Sites16, oslo50Sites16Vis2, bergen47Sites, bergen47Sites16, bergen66Sites16, }
\NormalTok{    bergen100Sites16, bergen140Sites16, bergen200Sites16, bergen50Sites16Vis2, }
\NormalTok{    trondheim47Sites, trondheim47Sites16, trondheim66Sites16, trondheim100Sites16, }
\NormalTok{    trondheim140Sites16, trondheim200Sites16, trondheim50Sites16Vis2, norge47Sites, }
\NormalTok{    norge47Sites16, norge66Sites16, norge100Sites16, norge140Sites16, norge200Sites16, }
\NormalTok{    norge50Sites16Vis2, }\DataTypeTok{file =} \StringTok{"survey_calc.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\DataTypeTok{file =} \StringTok{"survey_calc.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{surTab <-}\StringTok{ }\KeywordTok{tibble}\NormalTok{(}\DataTypeTok{Areal =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"Norge"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Bergen"}\NormalTok{, }\StringTok{"Trondheim"}\NormalTok{), }\DataTypeTok{times =} \DecValTok{6}\NormalTok{), }
    \StringTok{`}\DataTypeTok{Antall lokaliteter}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{47}\NormalTok{, }\DecValTok{66}\NormalTok{, }\DecValTok{100}\NormalTok{, }\DecValTok{140}\NormalTok{, }\DecValTok{200}\NormalTok{, }\DecValTok{50}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{), }\StringTok{`}\DataTypeTok{Antall besøk}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }
        \DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{), }\StringTok{`}\DataTypeTok{Deteksjonsrate 250x250m}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\FloatTok{0.426}\NormalTok{, }
        \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{, }\FloatTok{0.426}\NormalTok{, }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{, }\FloatTok{0.426}\NormalTok{, }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{))}







\NormalTok{surTab <-}\StringTok{ }\NormalTok{surTab }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\StringTok{`}\DataTypeTok{Deteksjonerate 1x1km}\StringTok{`}\NormalTok{ =}\StringTok{ `}\DataTypeTok{Deteksjonsrate 250x250m}\StringTok{`}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }
\StringTok{    `}\DataTypeTok{Antall besøk}\StringTok{`}\NormalTok{, }\DataTypeTok{Oppdagbarhet =} \KeywordTok{c}\NormalTok{(norge47Sites16}\OperatorTok{$}\NormalTok{probObs, oslo47Sites16}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    bergen47Sites16}\OperatorTok{$}\NormalTok{probObs, trondheim47Sites16}\OperatorTok{$}\NormalTok{probObs, norge66Sites16}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    oslo66Sites16}\OperatorTok{$}\NormalTok{probObs, bergen66Sites16}\OperatorTok{$}\NormalTok{probObs, trondheim66Sites16}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    norge100Sites16}\OperatorTok{$}\NormalTok{probObs, oslo100Sites16}\OperatorTok{$}\NormalTok{probObs, bergen100Sites16}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    trondheim100Sites16}\OperatorTok{$}\NormalTok{probObs, norge140Sites16}\OperatorTok{$}\NormalTok{probObs, oslo140Sites16}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    bergen140Sites16}\OperatorTok{$}\NormalTok{probObs, trondheim140Sites16}\OperatorTok{$}\NormalTok{probObs, norge200Sites16}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    oslo200Sites16}\OperatorTok{$}\NormalTok{probObs, bergen200Sites16}\OperatorTok{$}\NormalTok{probObs, trondheim200Sites16}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    norge50Sites16Vis2}\OperatorTok{$}\NormalTok{probObs, oslo50Sites16Vis2}\OperatorTok{$}\NormalTok{probObs, bergen50Sites16Vis2}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    trondheim50Sites16Vis2}\OperatorTok{$}\NormalTok{probObs))}

\CommentTok{# surTab}
\end{Highlighting}
\end{Shaded}

\blandscape

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{xtable}\NormalTok{(surTab, }\DataTypeTok{caption =} \StringTok{"Detection probabilities of a handful of survey regimes, with detection probabilities from an empiric survey."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}[ht]
\centering
\begin{tabular}{lrrrrr}
  \hline
Areal & Antall lokaliteter & Antall besøk & Deteksjonsrate 250x250m & Deteksjonerate 1x1km & Oppdagbarhet \\ 
  \hline
Norge & 47.00 & 1.00 & 0.43 & 0.03 & 0.01 \\ 
  Oslo & 47.00 & 1.00 & 0.43 & 0.03 & 0.03 \\ 
  Bergen & 47.00 & 1.00 & 0.43 & 0.03 & 0.02 \\ 
  Trondheim & 47.00 & 1.00 & 0.43 & 0.03 & 0.01 \\ 
  Norge & 66.00 & 1.00 & 0.64 & 0.04 & 0.03 \\ 
  Oslo & 66.00 & 1.00 & 0.64 & 0.04 & 0.04 \\ 
  Bergen & 66.00 & 1.00 & 0.64 & 0.04 & 0.04 \\ 
  Trondheim & 66.00 & 1.00 & 0.64 & 0.04 & 0.02 \\ 
  Norge & 100.00 & 1.00 & 0.43 & 0.03 & 0.02 \\ 
  Oslo & 100.00 & 1.00 & 0.43 & 0.03 & 0.04 \\ 
  Bergen & 100.00 & 1.00 & 0.43 & 0.03 & 0.03 \\ 
  Trondheim & 100.00 & 1.00 & 0.43 & 0.03 & 0.02 \\ 
  Norge & 140.00 & 1.00 & 0.64 & 0.04 & 0.05 \\ 
  Oslo & 140.00 & 1.00 & 0.64 & 0.04 & 0.10 \\ 
  Bergen & 140.00 & 1.00 & 0.64 & 0.04 & 0.07 \\ 
  Trondheim & 140.00 & 1.00 & 0.64 & 0.04 & 0.05 \\ 
  Norge & 200.00 & 1.00 & 0.43 & 0.03 & 0.05 \\ 
  Oslo & 200.00 & 1.00 & 0.43 & 0.03 & 0.07 \\ 
  Bergen & 200.00 & 1.00 & 0.43 & 0.03 & 0.07 \\ 
  Trondheim & 200.00 & 1.00 & 0.43 & 0.03 & 0.05 \\ 
  Norge & 50.00 & 2.00 & 0.64 & 0.08 & 0.04 \\ 
  Oslo & 50.00 & 2.00 & 0.64 & 0.08 & 0.07 \\ 
  Bergen & 50.00 & 2.00 & 0.64 & 0.08 & 0.05 \\ 
  Trondheim & 50.00 & 2.00 & 0.64 & 0.08 & 0.04 \\ 
   \hline
\end{tabular}
\caption{Detection probabilities of a handful of survey regimes, with detection probabilities from an empiric survey.} 
\end{table}

\elandscape

How much less is the prob using a subarea? (not much difference it
seems)

Calculate the same for 6 year period (cannot split 5 years in two, for
the alternative of repeated surveys each year.)

Run calculations for 6 years.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{oslo47Sites6Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo47Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo100Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{oslo66Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo200Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo140Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{## Bergen}
\NormalTok{bergen47Sites6Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen47Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen100Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{bergen66Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen200Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen140Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}




\NormalTok{## Trondheim}

\NormalTok{trondheim47Sites6Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim47Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim100Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{trondheim66Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim200Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim140Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge140Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\CommentTok{# Norge}
\NormalTok{norge47Sites6Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge47Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge100Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{norge66Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge200Sites166Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}



\NormalTok{## small expensive 2 visits, 1.5 detection prob}

\NormalTok{norge50Sites16Vis26Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo50Sites16Vis26Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{bergen50Sites16Vis26Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{trondheim50Sites16Vis26Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\KeywordTok{save}\NormalTok{(oslo47Sites6Years, oslo47Sites166Years, oslo66Sites166Years, oslo100Sites166Years, }
\NormalTok{    oslo140Sites166Years, oslo200Sites166Years, oslo50Sites16Vis26Years, bergen47Sites6Years, }
\NormalTok{    bergen47Sites166Years, bergen66Sites166Years, bergen100Sites166Years, bergen140Sites166Years, }
\NormalTok{    bergen200Sites166Years, bergen50Sites16Vis26Years, trondheim47Sites6Years, }
\NormalTok{    trondheim47Sites166Years, trondheim66Sites166Years, trondheim100Sites166Years, }
\NormalTok{    trondheim140Sites166Years, trondheim200Sites166Years, trondheim50Sites16Vis26Years, }
\NormalTok{    norge47Sites6Years, norge47Sites166Years, norge66Sites166Years, norge100Sites166Years, }
\NormalTok{    norge140Sites166Years, norge200Sites166Years, norge50Sites16Vis26Years, }
    \DataTypeTok{file =} \StringTok{"survey_calc6years.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"survey_calc6years.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{surTab6Years <-}\StringTok{ }\KeywordTok{tibble}\NormalTok{(}\DataTypeTok{Areal =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"Norge"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Bergen"}\NormalTok{, }\StringTok{"Trondheim"}\NormalTok{), }
    \DataTypeTok{times =} \DecValTok{6}\NormalTok{), }\StringTok{`}\DataTypeTok{Antall lokaliteter per år}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{47}\NormalTok{, }\DecValTok{66}\NormalTok{, }\DecValTok{100}\NormalTok{, }\DecValTok{140}\NormalTok{, }\DecValTok{200}\NormalTok{, }
    \DecValTok{50}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{), }\StringTok{`}\DataTypeTok{Antall lokaliteter totalt}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DecValTok{100} \OperatorTok{*}\StringTok{ }
\StringTok{    }\DecValTok{6}\NormalTok{, }\DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{), }\StringTok{`}\DataTypeTok{Antall besøk}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }
    \DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{), }\StringTok{`}\DataTypeTok{Deteksjonsrate 250x250m}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\FloatTok{0.426}\NormalTok{, }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{, }
    \FloatTok{0.426}\NormalTok{, }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{, }\FloatTok{0.426}\NormalTok{, }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{))}







\NormalTok{surTab6Years <-}\StringTok{ }\NormalTok{surTab6Years }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\StringTok{`}\DataTypeTok{Deteksjonerate 1x1km}\StringTok{`}\NormalTok{ =}\StringTok{ `}\DataTypeTok{Deteksjonsrate 250x250m}\StringTok{`}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }
\StringTok{    `}\DataTypeTok{Antall besøk}\StringTok{`}\NormalTok{, }\DataTypeTok{Oppdagbarhet =} \KeywordTok{c}\NormalTok{(norge47Sites166Years}\OperatorTok{$}\NormalTok{probObs, oslo47Sites166Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    bergen47Sites166Years}\OperatorTok{$}\NormalTok{probObs, trondheim47Sites166Years}\OperatorTok{$}\NormalTok{probObs, norge66Sites166Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    oslo66Sites166Years}\OperatorTok{$}\NormalTok{probObs, bergen66Sites166Years}\OperatorTok{$}\NormalTok{probObs, trondheim66Sites166Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    norge100Sites166Years}\OperatorTok{$}\NormalTok{probObs, oslo100Sites166Years}\OperatorTok{$}\NormalTok{probObs, bergen100Sites166Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    trondheim100Sites166Years}\OperatorTok{$}\NormalTok{probObs, norge140Sites166Years}\OperatorTok{$}\NormalTok{probObs, oslo140Sites166Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    bergen140Sites166Years}\OperatorTok{$}\NormalTok{probObs, trondheim140Sites166Years}\OperatorTok{$}\NormalTok{probObs, norge200Sites166Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    oslo200Sites166Years}\OperatorTok{$}\NormalTok{probObs, bergen200Sites166Years}\OperatorTok{$}\NormalTok{probObs, trondheim200Sites166Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    norge50Sites16Vis26Years}\OperatorTok{$}\NormalTok{probObs, oslo50Sites16Vis26Years}\OperatorTok{$}\NormalTok{probObs, bergen50Sites16Vis26Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    trondheim50Sites16Vis26Years}\OperatorTok{$}\NormalTok{probObs))}

\CommentTok{# surTab}
\end{Highlighting}
\end{Shaded}

\blandscape

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{xtable}\NormalTok{(surTab6Years, }\DataTypeTok{caption =} \StringTok{"Detection probabilities of a handful of survey regimes, with detection probabilities from an empiric survey. 6 years of surveying visiting each location only one year."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}[ht]
\centering
\begin{tabular}{lrrrrrr}
  \hline
Areal & Antall lokaliteter per år & Antall lokaliteter totalt & Antall besøk & Deteksjonsrate 250x250m & Deteksjonerate 1x1km & Oppdagbarhet \\ 
  \hline
Norge & 47.00 & 282.00 & 1.00 & 0.43 & 0.03 & 0.06 \\ 
  Oslo & 47.00 & 282.00 & 1.00 & 0.43 & 0.03 & 0.08 \\ 
  Bergen & 47.00 & 282.00 & 1.00 & 0.43 & 0.03 & 0.09 \\ 
  Trondheim & 47.00 & 282.00 & 1.00 & 0.43 & 0.03 & 0.07 \\ 
  Norge & 66.00 & 396.00 & 1.00 & 0.64 & 0.04 & 0.17 \\ 
  Oslo & 66.00 & 396.00 & 1.00 & 0.64 & 0.04 & 0.18 \\ 
  Bergen & 66.00 & 396.00 & 1.00 & 0.64 & 0.04 & 0.19 \\ 
  Trondheim & 66.00 & 396.00 & 1.00 & 0.64 & 0.04 & 0.12 \\ 
  Norge & 100.00 & 600.00 & 1.00 & 0.43 & 0.03 & 0.14 \\ 
  Oslo & 100.00 & 600.00 & 1.00 & 0.43 & 0.03 & 0.17 \\ 
  Bergen & 100.00 & 600.00 & 1.00 & 0.43 & 0.03 & 0.18 \\ 
  Trondheim & 100.00 & 600.00 & 1.00 & 0.43 & 0.03 & 0.12 \\ 
  Norge & 140.00 & 840.00 & 1.00 & 0.64 & 0.04 & 0.29 \\ 
  Oslo & 140.00 & 840.00 & 1.00 & 0.64 & 0.04 & 0.30 \\ 
  Bergen & 140.00 & 840.00 & 1.00 & 0.64 & 0.04 & 0.34 \\ 
  Trondheim & 140.00 & 840.00 & 1.00 & 0.64 & 0.04 & 0.21 \\ 
  Norge & 200.00 & 1200.00 & 1.00 & 0.43 & 0.03 & 0.28 \\ 
  Oslo & 200.00 & 1200.00 & 1.00 & 0.43 & 0.03 & 0.28 \\ 
  Bergen & 200.00 & 1200.00 & 1.00 & 0.43 & 0.03 & 0.34 \\ 
  Trondheim & 200.00 & 1200.00 & 1.00 & 0.43 & 0.03 & 0.19 \\ 
  Norge & 50.00 & 300.00 & 2.00 & 0.64 & 0.08 & 0.23 \\ 
  Oslo & 50.00 & 300.00 & 2.00 & 0.64 & 0.08 & 0.27 \\ 
  Bergen & 50.00 & 300.00 & 2.00 & 0.64 & 0.08 & 0.25 \\ 
  Trondheim & 50.00 & 300.00 & 2.00 & 0.64 & 0.08 & 0.17 \\ 
   \hline
\end{tabular}
\caption{Detection probabilities of a handful of survey regimes, with detection probabilities from an empiric survey. 6 years of surveying visiting each location only one year.} 
\end{table}

\elandscape

Calculate the same but where we revisit each location 2 times. With 47
lokations per year, this gives us in total 47*3 = 141 locations but
double the area covered within the same location. We can also measure
the spread of known distibutions between the 3 years.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{oslo47Sites3Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo47Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo100Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{oslo66Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo200Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo140Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{## Bergen}
\NormalTok{bergen47Sites3Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen47Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen100Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{bergen66Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen200Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{bergen140Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}




\NormalTok{## Trondheim}

\NormalTok{trondheim47Sites3Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim47Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim100Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{trondheim66Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim200Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{trondheim140Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge140Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\CommentTok{# Norge}
\NormalTok{norge47Sites3Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge47Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge100Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{100} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{norge66Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norge200Sites163Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }
    \DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}



\NormalTok{## small expensive 2 visits, 1.5 detection prob}

\NormalTok{norge50Sites16Vis23Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }
    \DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{oslo50Sites16Vis23Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ osloVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }
    \DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{bergen50Sites16Vis23Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ bergenVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }
    \DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{trondheim50Sites16Vis23Years <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ trondheimVisWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{6}\NormalTok{, }\DataTypeTok{detectProb =} \DecValTok{2} \OperatorTok{*}\StringTok{ }\DecValTok{2} \OperatorTok{*}\StringTok{ }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\OperatorTok{/}\DecValTok{16}\NormalTok{, }
    \DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\KeywordTok{save}\NormalTok{(oslo47Sites3Years, oslo47Sites163Years, oslo66Sites163Years, oslo100Sites163Years, }
\NormalTok{    oslo140Sites163Years, oslo200Sites163Years, oslo50Sites16Vis23Years, bergen47Sites3Years, }
\NormalTok{    bergen47Sites163Years, bergen66Sites163Years, bergen100Sites163Years, bergen140Sites163Years, }
\NormalTok{    bergen200Sites163Years, bergen50Sites16Vis23Years, trondheim47Sites3Years, }
\NormalTok{    trondheim47Sites163Years, trondheim66Sites163Years, trondheim100Sites163Years, }
\NormalTok{    trondheim140Sites163Years, trondheim200Sites163Years, trondheim50Sites16Vis23Years, }
\NormalTok{    norge47Sites3Years, norge47Sites163Years, norge66Sites163Years, norge100Sites163Years, }
\NormalTok{    norge140Sites163Years, norge200Sites163Years, norge50Sites16Vis23Years, }
    \DataTypeTok{file =} \StringTok{"survey_calc3Years.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"survey_calc3Years.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{surTab3years <-}\StringTok{ }\KeywordTok{tibble}\NormalTok{(}\DataTypeTok{Areal =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"Norge"}\NormalTok{, }\StringTok{"Oslo"}\NormalTok{, }\StringTok{"Bergen"}\NormalTok{, }\StringTok{"Trondheim"}\NormalTok{), }
    \DataTypeTok{times =} \DecValTok{6}\NormalTok{), }\StringTok{`}\DataTypeTok{Antall lokaliteter per år}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{47}\NormalTok{, }\DecValTok{66}\NormalTok{, }\DecValTok{100}\NormalTok{, }\DecValTok{140}\NormalTok{, }\DecValTok{200}\NormalTok{, }
    \DecValTok{50}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{), }\StringTok{`}\DataTypeTok{Antall lokaliteter totalt}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{47} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DecValTok{66} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DecValTok{100} \OperatorTok{*}\StringTok{ }
\StringTok{    }\DecValTok{3}\NormalTok{, }\DecValTok{140} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DecValTok{200} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{, }\DecValTok{50} \OperatorTok{*}\StringTok{ }\DecValTok{3}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{), }\StringTok{`}\DataTypeTok{Antall besøk}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }
    \DecValTok{1} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DecValTok{1} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DecValTok{1} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DecValTok{1} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{, }\DecValTok{2} \OperatorTok{*}\StringTok{ }\DecValTok{2}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{), }\StringTok{`}\DataTypeTok{Deteksjonsrate 250x250m}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\FloatTok{0.426}\NormalTok{, }
    \FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{, }\FloatTok{0.426}\NormalTok{, }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{, }\FloatTok{0.426}\NormalTok{, }\FloatTok{0.426} \OperatorTok{*}\StringTok{ }\FloatTok{1.5}\NormalTok{), }\DataTypeTok{each =} \DecValTok{4}\NormalTok{))}







\NormalTok{surTab3years <-}\StringTok{ }\NormalTok{surTab3years }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\StringTok{`}\DataTypeTok{Deteksjonerate 1x1km}\StringTok{`}\NormalTok{ =}\StringTok{ `}\DataTypeTok{Deteksjonsrate 250x250m}\StringTok{`}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }
\StringTok{    `}\DataTypeTok{Antall besøk}\StringTok{`}\NormalTok{, }\DataTypeTok{Oppdagbarhet =} \KeywordTok{c}\NormalTok{(norge47Sites163Years}\OperatorTok{$}\NormalTok{probObs, oslo47Sites163Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    bergen47Sites163Years}\OperatorTok{$}\NormalTok{probObs, trondheim47Sites163Years}\OperatorTok{$}\NormalTok{probObs, norge66Sites163Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    oslo66Sites163Years}\OperatorTok{$}\NormalTok{probObs, bergen66Sites163Years}\OperatorTok{$}\NormalTok{probObs, trondheim66Sites163Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    norge100Sites163Years}\OperatorTok{$}\NormalTok{probObs, oslo100Sites163Years}\OperatorTok{$}\NormalTok{probObs, bergen100Sites163Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    trondheim100Sites163Years}\OperatorTok{$}\NormalTok{probObs, norge140Sites163Years}\OperatorTok{$}\NormalTok{probObs, oslo140Sites163Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    bergen140Sites163Years}\OperatorTok{$}\NormalTok{probObs, trondheim140Sites163Years}\OperatorTok{$}\NormalTok{probObs, norge200Sites163Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    oslo200Sites163Years}\OperatorTok{$}\NormalTok{probObs, bergen200Sites163Years}\OperatorTok{$}\NormalTok{probObs, trondheim200Sites163Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    norge50Sites16Vis23Years}\OperatorTok{$}\NormalTok{probObs, oslo50Sites16Vis23Years}\OperatorTok{$}\NormalTok{probObs, bergen50Sites16Vis23Years}\OperatorTok{$}\NormalTok{probObs, }
\NormalTok{    trondheim50Sites16Vis23Years}\OperatorTok{$}\NormalTok{probObs))}

\CommentTok{# surTab}
\end{Highlighting}
\end{Shaded}

\blandscape

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{xtable}\NormalTok{(surTab3years, }\DataTypeTok{caption =} \StringTok{"Detection probabilities of a handful of survey regimes, with detection probabilities from an empiric survey. 6 year period visiting each location 2 years."}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}[ht]
\centering
\begin{tabular}{lrrrrrr}
  \hline
Areal & Antall lokaliteter per år & Antall lokaliteter totalt & Antall besøk & Deteksjonsrate 250x250m & Deteksjonerate 1x1km & Oppdagbarhet \\ 
  \hline
Norge & 47.00 & 141.00 & 2.00 & 0.43 & 0.05 & 0.07 \\ 
  Oslo & 47.00 & 141.00 & 2.00 & 0.43 & 0.05 & 0.12 \\ 
  Bergen & 47.00 & 141.00 & 2.00 & 0.43 & 0.05 & 0.10 \\ 
  Trondheim & 47.00 & 141.00 & 2.00 & 0.43 & 0.05 & 0.07 \\ 
  Norge & 66.00 & 198.00 & 2.00 & 0.64 & 0.08 & 0.16 \\ 
  Oslo & 66.00 & 198.00 & 2.00 & 0.64 & 0.08 & 0.24 \\ 
  Bergen & 66.00 & 198.00 & 2.00 & 0.64 & 0.08 & 0.20 \\ 
  Trondheim & 66.00 & 198.00 & 2.00 & 0.64 & 0.08 & 0.12 \\ 
  Norge & 100.00 & 300.00 & 2.00 & 0.43 & 0.05 & 0.14 \\ 
  Oslo & 100.00 & 300.00 & 2.00 & 0.43 & 0.05 & 0.19 \\ 
  Bergen & 100.00 & 300.00 & 2.00 & 0.43 & 0.05 & 0.19 \\ 
  Trondheim & 100.00 & 300.00 & 2.00 & 0.43 & 0.05 & 0.12 \\ 
  Norge & 140.00 & 420.00 & 2.00 & 0.64 & 0.08 & 0.31 \\ 
  Oslo & 140.00 & 420.00 & 2.00 & 0.64 & 0.08 & 0.37 \\ 
  Bergen & 140.00 & 420.00 & 2.00 & 0.64 & 0.08 & 0.37 \\ 
  Trondheim & 140.00 & 420.00 & 2.00 & 0.64 & 0.08 & 0.25 \\ 
  Norge & 200.00 & 600.00 & 2.00 & 0.43 & 0.05 & 0.29 \\ 
  Oslo & 200.00 & 600.00 & 2.00 & 0.43 & 0.05 & 0.30 \\ 
  Bergen & 200.00 & 600.00 & 2.00 & 0.43 & 0.05 & 0.33 \\ 
  Trondheim & 200.00 & 600.00 & 2.00 & 0.43 & 0.05 & 0.20 \\ 
  Norge & 50.00 & 150.00 & 4.00 & 0.64 & 0.16 & 0.19 \\ 
  Oslo & 50.00 & 150.00 & 4.00 & 0.64 & 0.16 & 0.47 \\ 
  Bergen & 50.00 & 150.00 & 4.00 & 0.64 & 0.16 & 0.46 \\ 
  Trondheim & 50.00 & 150.00 & 4.00 & 0.64 & 0.16 & 0.33 \\ 
   \hline
\end{tabular}
\caption{Detection probabilities of a handful of survey regimes, with detection probabilities from an empiric survey. 6 year period visiting each location 2 years.} 
\end{table}

\elandscape

Calculate the number of locations and visits needed given the empirical
detection rates.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{norgeDet0.426Vis1 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{100}\NormalTok{), }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16}\NormalTok{, }
    \DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\NormalTok{norgeDet0.426Vis4 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{100}\NormalTok{), }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }
\StringTok{        }\DecValTok{4}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norgeDet0.426Vis10 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{100}\NormalTok{), }\DataTypeTok{detectProb =} \FloatTok{0.426}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }
\StringTok{        }\DecValTok{10}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norgeDet0.639Vis1 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{100}\NormalTok{), }\DataTypeTok{detectProb =} \FloatTok{0.639}\OperatorTok{/}\DecValTok{16}\NormalTok{, }
    \DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norgeDet0.639Vis4 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{100}\NormalTok{), }\DataTypeTok{detectProb =} \FloatTok{0.639}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }
\StringTok{        }\DecValTok{4}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}

\NormalTok{norgeDet0.639Vis10 <-}\StringTok{ }\KeywordTok{weightedDetection}\NormalTok{(}\DataTypeTok{occWeights =}\NormalTok{ occWeights, }\DataTypeTok{visWeights =}\NormalTok{ occWeights, }
    \DataTypeTok{noOccur =} \DecValTok{500}\NormalTok{, }\DataTypeTok{noLocations =} \KeywordTok{seq}\NormalTok{(}\DecValTok{100}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DataTypeTok{by =} \DecValTok{100}\NormalTok{), }\DataTypeTok{detectProb =} \FloatTok{0.639}\OperatorTok{/}\DecValTok{16} \OperatorTok{*}\StringTok{ }
\StringTok{        }\DecValTok{10}\NormalTok{, }\DataTypeTok{nIter =} \DecValTok{999}\NormalTok{, }\DataTypeTok{noVisits =} \DecValTok{1}\NormalTok{)}


\KeywordTok{save}\NormalTok{(norgeDet0.426Vis1, norgeDet0.426Vis4, norgeDet0.426Vis10, norgeDet0.639Vis1, }
\NormalTok{    norgeDet0.639Vis4, norgeDet0.639Vis10, }\DataTypeTok{file =} \StringTok{"neededLocEmp.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{load}\NormalTok{(}\StringTok{"neededLocEmp.Rdata"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(norgeDet0.426Vis1, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/norgeDet0.426Vis1-1.png}
\caption{Observation probability given a detection probability of 0.426
with 1 visit to a 1/16 part of a 1km\^{}2 cell. Sampling the whole
country.}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(norgeDet0.426Vis4, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/norgeDet0.426Vis4-1.png}
\caption{Observation probability given a detection probability of 0.426
with 1 visits to 4 1/16 parts of a 1km\^{}2 cell. Sampling the whole
country.}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(norgeDet0.426Vis10, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/norgeDet0.426Vis10-1.png}
\caption{Observation probability given a detection probability of 0.426
with 1 visits to 10 1/16 parts of a 1km\^{}2 cell. Sampling the whole
country.}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(norgeDet0.639Vis1, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/norgeDet0.639Vis1-1.png}
\caption{Observation probability given a detection probability of 0.639
with one visit to a 1/16 part of a 1km\^{}2 cell. Sampling the whole
country.}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(norgeDet0.639Vis4, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/norgeDet0.639Vis4-1.png}
\caption{Observation probability given a detection probability of 0.639
with one visit to 4 1/16 parts of a 1km\^{}2 cell. Sampling the whole
country.}
\end{figure}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(norgeDet0.639Vis10, }\DataTypeTok{threshold =} \FloatTok{0.8}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{"Antall lokaliteter"}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{"Observasjonssannsynlighet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}
\centering
\includegraphics{figure/norgeDet0.639Vis10-1.png}
\caption{Observation probability given a detection probability of 0.639
with one visit to 10 1/16 parts of a 1km\^{}2 cell. Sampling the whole
country.}
\end{figure}

\section{References}\label{references}

Pavlos S. Efraimidis, Paul G. Spirakis, Weighted random sampling with a
reservoir, Information Processing Letters, Volume 97, Issue 5, 16 March
2006, Pages 181-185, ISSN 0020-0190, 10.1016/j.ipl.2005.11.003.


\end{document}
